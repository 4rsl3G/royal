<!-- views/admin/orders.ejs (UPDATED - NO inline JS, Grid.js mount point + premium modal) -->
<div data-admin-page="orders" class="fade-up">

  <div class="card card-pad scanline">
    <div class="card-row">
      <div class="min-w-0">
        <div class="pill"><i class="ri-file-list-3-line"></i> Management</div>
        <div class="card-title mt-2">Orders</div>
        <div class="card-sub">Filter, cari, dan update fulfill status + catatan admin.</div>
      </div>

      <div class="flex gap-2 flex-wrap">
        <button class="btn btn-ghost" id="btnRefresh"><i class="ri-refresh-line"></i> Refresh</button>
        <button class="btn btn-primary shimmer" id="btnQuickPending"><i class="ri-time-line"></i> Pending</button>
        <button class="btn btn-primary shimmer" id="btnQuickWaiting"><i class="ri-hourglass-2-line"></i> Waiting</button>
      </div>
    </div>

    <div class="mt-4 form-grid">
      <div class="col-6">
        <div class="label">Search</div>
        <input id="q" class="input" placeholder="order_id / game_id / wa / product" />
      </div>

      <div class="col-3">
        <div class="label">Pay Status</div>
        <select id="pay_status" class="select">
          <option value="">all</option>
          <option>pending</option>
          <option>settlement</option>
          <option>capture</option>
          <option>expire</option>
          <option>cancel</option>
          <option>deny</option>
          <option>failure</option>
        </select>
      </div>

      <div class="col-3">
        <div class="label">Fulfill</div>
        <select id="fulfill_status" class="select">
          <option value="">all</option>
          <option value="waiting">waiting</option>
          <option value="processing">processing</option>
          <option value="done">done</option>
          <option value="rejected">rejected</option>
        </select>
      </div>

      <div class="col-12">
        <div class="help">
          Tip: gunakan quick filter “Pending” untuk cek pembayaran, dan “Waiting” untuk antrian proses.
        </div>
      </div>
    </div>
  </div>

  <div class="mt-4 card card-pad">
    <div class="card-row">
      <div class="font-extrabold text-lg">Orders Table</div>
      <div class="pill"><i class="ri-database-2-line"></i> <span id="countBox">0</span> items</div>
    </div>

    <div class="mt-3 help">Showing <b>5</b> per page. Gunakan pagination di bawah table.</div>

    <!-- Scroll ONLY in this card -->
    <div class="mt-4 rd-orders-scroll">
      <div id="ordersGrid"></div>
    </div>
  </div>

  <!-- MODAL -->
  <div id="modal" class="rd-modal hidden" aria-hidden="true">
    <div class="rd-modal-backdrop" id="modalBackdrop"></div>

    <div class="rd-modal-wrap" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <div class="rd-modal-card">
        <div class="rd-modal-head">
          <div class="min-w-0">
            <div id="modalTitle" class="font-extrabold text-lg">Update Fulfill</div>
            <div class="text-sm text-slate-500">Update status + admin note (dipakai template WA).</div>
          </div>
          <button class="btn btn-ghost" id="closeModal" aria-label="Close"><i class="ri-close-line"></i></button>
        </div>

        <div class="rd-modal-body">
          <div class="grid md:grid-cols-2 gap-3">
            <div class="card soft card-pad" style="border-radius:18px;border:1px solid var(--line2);">
              <div class="text-xs text-slate-500">Order ID</div>
              <div class="font-extrabold mt-1 break-anywhere" id="mOrderId">-</div>
              <div class="text-xs text-slate-500 mt-3">Pay</div>
              <div class="mt-1" id="mPayBadge">-</div>
              <div class="text-xs text-slate-500 mt-3">Gross</div>
              <div class="font-extrabold mt-1" id="mGross">-</div>
            </div>

            <div class="card soft card-pad" style="border-radius:18px;border:1px solid var(--line2);">
              <div class="label">Fulfill Status</div>
              <select id="mFulfill" class="select">
                <option value="waiting">waiting</option>
                <option value="processing">processing</option>
                <option value="done">done</option>
                <option value="rejected">rejected</option>
              </select>

              <div class="label mt-3">Admin Note</div>
              <textarea id="mNote" class="textarea" rows="5" placeholder="Catatan untuk customer (dipakai di template WA)"></textarea>

              <div class="mt-3">
                <button class="btn btn-primary shimmer btn-block" id="saveBtn">
                  <i class="ri-save-3-line"></i> Simpan
                </button>
              </div>
            </div>
          </div>

          <div class="mt-3 help">
            Saran: set “processing” saat mulai pengerjaan. “done”/“rejected” akan memicu template WA (jika enabled + connected).
          </div>
        </div>
      </div>
    </div>
  </div>

</div>
